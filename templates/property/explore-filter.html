<style> 
    .explore-filter-popover {
        display: none;
        flex-direction: column;
        position: absolute;
        top: 0;
        left: 0; 
        right: 0; 
        margin-left: auto; 
        margin-right: auto;
        height: 100vh;
        justify-content: flex-start;
        align-items: center;
        overflow-y: hidden;
        transform: translateY(0%);
        transition: transform ease 300ms;
        z-index: 9999;
    }

    .popover-hidden {
        transform: translateY(100%);
    }

    @media only screen and (min-width: 600px) {
        #explore-filter-popover {
            top: 0;
        }
    }

    #explore-filter {
        width: 100%;
        height: 100%;
        overflow-y: scroll;
        padding: 50px 0 200px 0;
        /* position: relative!important; */
    }

    #explore-filter p {
        font-weight: bold;
        margin:0;
    }   

    #explore-filter label {
        font-weight: bold;
    }
    
    #explore-filter input, select {
        width: 100%;
        padding: 7px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
</style>

<script>
    function updateSliderValue() {
        const slider = document.getElementById("cap-rate-input");
        const output = document.getElementById("cap-rate-value");
        output.innerHTML = slider.value;
    }

    function hideFilterPopover() {
        const filterPopover = document.getElementById("explore-filter-popover");
        filterPopover.classList.toggle("popover-hidden");
        setTimeout(() => {
            filterPopover.style.display = "none";
        }, 100);  
    }

    function resetFilterForm() {
        const filterForm = document.getElementById("explore-filter");
        filterForm.reset();
        document.getElementById("cap-rate-value").innerHTML = 5;
    }
</script>

<div id="explore-filter-popover" class="col-sm-12 mx-auto justify-content-center bg-dark explore-filter-popover popover-hidden">

    <div class="col-sm-4 h-100 justify-content-center position-relative" style="z-index:10;"> 

    <div 
    id="explore-filter-header" 
    class="d-flex justify-content-center align-items-center border-bottom border-light fixed-top bg-dark w-100 py-2 px-3"
    style="margin-top:-1px; z-index: 999;"
    >
        <div class="col-12 col-sm-4">
            <div class="d-flex justify-content-between w-100">
                <p class="mb-0 fs-3">Filter</p>
                <button class="btn btn-lg border-0 fs-2 p-0 m-0" onclick="hideFilterPopover()">
                    <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width="24" 
                    height="24" 
                    fill="currentColor" 
                    class="bi bi-x-lg" viewBox="0 0 16 16"
                    >
                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <form id="explore-filter" class="col-sm-4 px-3">

        <div id="cap-rate-filter-container" class="d-flex justify-content-between my-4">
            <label for="cap-rate">Cap Rate</label>
            <input type="range" min="0" max="100" value="5" class="slider" style="width: 60% !important;" id="cap-rate-input" name="cap-rate"
            oninput="updateSliderValue()"
            >
            <div class="d-flex">
                <p id="cap-rate-value">5</p>
                <p>% +</p>
            </div>
        </div>

        <div id="price-filter-container" class="d-flex justify-content-evenly align-items-center my-4">
            <div style="text-align: left;">
                <label class="mb-2" for="min-price">Min Price</label>
                <select id="min-price" name="min-price">
                    <option value="0">No Min</option>
                    <option value="50000">$50,000</option>
                    <option value="100000">$100,000</option>
                    <option value="150000">$150,000</option>
                    <option value="200000">$200,000</option>
                    <option value="250000">$250,000</option>
                    <option value="300000">$300,000</option>
                    <option value="350000">$350,000</option>
                    <option value="400000">$400,000</option>
                    <option value="450000">$450,000</option>
                    <option value="500000">$500,000</option>
                    <option value="550000">$550,000</option>
                    <option value="600000">$600,000</option>
                    <option value="650000">$650,000</option>
                    <option value="700000">$700,000</option>
                    <option value="750000">$750,000</option>
                    <option value="800000">$800,000</option>
                    <option value="850000">$850,000</option>
                    <option value="900000">$900,000</option>
                    <option value="950000">$950,000</option>
                    <option value="1000000">$1M</option>
                    <option value="1500000">$1.5M</option>
                    <option value="2000000">$2M</option>
                    <option value="2500000">$2.5M</option>
                    <option value="3000000">$3M</option>
                    <option value="3500000">$3.5M</option>
                    <option value="4000000">$4M</option>
                    <option value="4500000">$4.5M</option>
                    <option value="5000000">$5M</option>
                    <option value="5500000">$5.5M</option>
                    <option value="6000000">$6M</option>
                    <option value="6500000">$6.5M</option>
                    <option value="7000000">$7M</option>
                    <option value="7500000">$7.5M</option>
                    <option value="8000000">$8M</option>
                    <option value="8500000">$8.5M</option>
                    <option value="9000000">$9M</option>
                    <option value="9500000">$9.5M</option>
                    <option value="10000000">$10M</option>
                    <option value="15000000">$15M</option>
                    <option value="16000000">$16M</option>
                    <option value="17000000">$17M</option>
                    <option value="18000000">$18M</option>
                </select>
            </div>
            <p style="margin: 20px 10px 0 10px;"> - </p>
            <div style="text-align: left;">
                <label class="mb-2" for="max-price">Max Price</label>
                <select id="max-price" name="max-price">
                    <option value="0">No Max</option>
                    <option value="50000">$50,000</option>
                    <option value="100000">$100,000</option>
                    <option value="150000">$150,000</option>
                    <option value="200000">$200,000</option>
                    <option value="250000">$250,000</option>
                    <option value="300000">$300,000</option>
                    <option value="350000">$350,000</option>
                    <option value="400000">$400,000</option>
                    <option value="450000">$450,000</option>
                    <option value="500000">$500,000</option>
                    <option value="550000">$550,000</option>
                    <option value="600000">$600,000</option>
                    <option value="650000">$650,000</option>
                    <option value="700000">$700,000</option>
                    <option value="750000">$750,000</option>
                    <option value="800000">$800,000</option>
                    <option value="850000">$850,000</option>
                    <option value="900000">$900,000</option>
                    <option value="950000">$950,000</option>
                    <option value="1000000">$1M</option>
                    <option value="1500000">$1.5M</option>
                    <option value="2000000">$2M</option>
                    <option value="2500000">$2.5M</option>
                    <option value="3000000">$3M</option>
                    <option value="3500000">$3.5M</option>
                    <option value="4000000">$4M</option>
                    <option value="4500000">$4.5M</option>
                    <option value="5000000">$5M</option>
                    <option value="5500000">$5.5M</option>
                    <option value="6000000">$6M</option>
                    <option value="6500000">$6.5M</option>
                    <option value="7000000">$7M</option>
                    <option value="7500000">$7.5M</option>
                    <option value="8000000">$8M</option>
                    <option value="8500000">$8.5M</option>
                    <option value="9000000">$9M</option>
                    <option value="9500000">$9.5M</option>
                    <option value="10000000">$10M</option>
                    <option value="15000000">$15M</option>
                    <option value="16000000">$16M</option>
                    <option value="17000000">$17M</option>
                    <option value="18000000">$18M</option>
                </select>
            </div>
        </div>

        <div id="br-filter-container" class="d-flex justify-content-start my-4"> 
            <div style="display:flex; flex-direction: column;">
                <label for="bedrooms" class="mb-2">Bedrooms</label>
                <select id="bedrooms" name="bedrooms">
                    <option value="0">Any</option>
                    <option value="1">1+</option>
                    <option value="2">2+</option>
                    <option value="3">3+</option>
                    <option value="4">4+</option>
                    <option value="5">5+</option>
                </select>
            </div>
        </div>

        <div id="bath-filter-container" class="d-flex justify-content-start my-4"> 
            <div style="display:flex; flex-direction: column;">
                <label for="bathrooms" class="mb-2">Bathrooms</label> 
                <select id="bathrooms" name="bathrooms">
                    <option value="0">Any</option>
                    <option value="1">1+</option>
                    <option value="2">2+</option>
                    <option value="3">3+</option>
                    <option value="4">4+</option>
                </select>
            </div>
        </div>

        <div id="sqfeet-filter-container" class="d-flex justify-content-evenly my-4" style="flex-direction: column;">
            <p class="mb-2">Square Feet</p>
            <div class="d-flex w-100">
                <select id="min-sqfeet" name="min-sqfeet">
                    <option value="0">No Min</option>
                    <option value="500">500</option>
                    <option value="750">750</option>
                    <option value="1000">1000</option>
                    <option value="1250">1250</option>
                    <option value="1500">1500</option>
                    <option value="1750">1750</option>
                    <option value="2000">2000</option>
                    <option value="2250">2250</option>
                    <option value="2500">2500</option>
                    <option value="2750">2750</option>
                    <option value="3000">3000</option>
                    <option value="3250">3250</option>
                    <option value="3500">3500</option>
                    <option value="3750">3750</option>
                    <option value="4000">4000</option>
                    <option value="4250">4250</option>
                    <option value="4500">4500</option>
                    <option value="4750">4750</option>
                    <option value="5000">5000</option>
                    <option value="5250">5250</option>
                    <option value="5500">5500</option>
                    <option value="5750">5750</option>
                    <option value="6000">6000</option>
                    <option value="6250">6250</option>
                    <option value="6500">6500</option>
                    <option value="6750">6750</option>
                    <option value="7000">7000</option>
                    <option value="7250">7250</option>
                    <option value="7500">7500</option>
                </select>
                <p style="margin: 0 10px;"> - </p>
                <select id="max-sqfeet" name="max-sqfeet">
                    <option value="0">No Max</option>
                    <option value="500">500</option>
                    <option value="750">750</option>
                    <option value="1000">1000</option>
                    <option value="1250">1250</option>
                    <option value="1500">1500</option>
                    <option value="1750">1750</option>
                    <option value="2000">2000</option>
                    <option value="2250">2250</option>
                    <option value="2500">2500</option>
                    <option value="2750">2750</option>
                    <option value="3000">3000</option>
                    <option value="3250">3250</option>
                    <option value="3500">3500</option>
                    <option value="3750">3750</option>
                    <option value="4000">4000</option>
                    <option value="4250">4250</option>
                    <option value="4500">4500</option>
                    <option value="4750">4750</option>
                    <option value="5000">5000</option>
                    <option value="5250">5250</option>
                    <option value="5500">5500</option>
                    <option value="5750">5750</option>
                    <option value="6000">6000</option>
                    <option value="6250">6250</option>
                    <option value="6500">6500</option>
                    <option value="6750">6750</option>
                    <option value="7000">7000</option>
                    <option value="7250">7250</option>
                    <option value="7500">7500</option>
                </select>
            </div>
        </div>

        <div id="lot-size-filter-container" class="d-flex justify-content-evenly my-4" style="flex-direction: column;">
            <p class="mb-2">Lot Size</p>
            <div class="d-flex w-100">
                <select id="lotSize-min" name="lotSize-min" aria-label="Lot size min">
                    <option value="0">No Min</option>
                    <option value="1000">1,000 sqft</option>
                    <option value="2000">2,000 sqft</option>
                    <option value="3000">3,000 sqft</option>
                    <option value="4000">4,000 sqft</option>
                    <option value="5000">5,000 sqft</option>
                    <option value="7500">7,500 sqft</option>
                    <option value="10890">1/4 acre/10,890 sqft</option>
                    <option value="21780">1/2 acre</option>
                    <option value="43560">1 acre</option>
                    <option value="87120">2 acres</option>
                    <option value="217800">5 acres</option>
                    <option value="435600">10 acres</option>
                    <option value="871200">20 acres</option>
                    <option value="2178000">50 acres</option>
                    <option value="4356000">100 acres</option>
                </select>
                <p style="margin: 0 10px;"> - </p>
                <select id="lotSize-max" name="lotSize-max" aria-label="Lot size max">
                    <option value="0">No Max</option>
                    <option value="1000">1,000 sqft</option>
                    <option value="2000">2,000 sqft</option>
                    <option value="3000">3,000 sqft</option>
                    <option value="4000">4,000 sqft</option>
                    <option value="5000">5,000 sqft</option>
                    <option value="7500">7,500 sqft</option>
                    <option value="10890">1/4 acre/10,890 sqft</option>
                    <option value="21780">1/2 acre</option>
                    <option value="43560">1 acre</option>
                    <option value="87120">2 acres</option>
                    <option value="217800">5 acres</option>
                    <option value="435600">10 acres</option>
                    <option value="871200">20 acres</option>
                    <option value="2178000">50 acres</option>
                    <option value="4356000">100 acres</option>
                </select>
            </div>
        </div>

        <div id="year-built-filter-container" class="d-flex justify-content-evenly my-4" style="flex-direction: column;">
            <p class="mb-2">Year Built</p>
            <div class="d-flex w-100">
                <input type="number" id="min-year" name="min-year" min="0" max="10000000" placeholder="No Min">
                <p style="margin: 0 10px;"> - </p>
                <input type="number" id="max-year" name="max-year" min="0" max="10000000" placeholder="No Max">
            </div>
        </div>

    </form>

    <div 
    id="explore-filter-submit" 
    class="d-flex justify-content-center border-top border-light align-items-center fixed-bottom w-100 bg-dark py-1 px-3"
    style="margin-bottom:-1px; bottom:100px;"
    >
        <div class="col-12 col-sm-4">
            <div class="d-flex justify-content-between w-100">
                <button 
                class="btn btn-outline-info border-2 mt-1" 
                style="width:45%; font-weight:bold;" 
                onclick="resetFilterForm()"
                >Reset Filters</button>

                <button 
                class="btn btn-outline-light border-2 mt-1"
                style="width:45%; font-weight:bold;"
                hx-get="{% url 'explore' %}"
                hx-include="#explore-filter"
                hx-target="#property-card-container"
                hx-swap="outerHTML"
                onclick="hideFilterPopover()"
                >Apply Filters</button>
            </div>
        </div>
    </div>

    </div>

</div>